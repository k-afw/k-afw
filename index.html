<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Discover Your Daily Fortune</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  <h1>Discover Your Daily Fortune</h1>

  <div>
    <label>Enter your birthdate:</label><br>
    <input type="number" id="year" placeholder="Year">
    <input type="number" id="month" placeholder="Month">
    <input type="number" id="day" placeholder="Day">
    <button onclick="generateFortune()">Get My Fortune</button>
  </div>

  <div id="result"></div>

  <script>
    const base = 'https://k-afw.github.io/k-afw';

    const zodiacSigns = [
      "Capricorn", "Aquarius", "Pisces", "Aries", "Taurus", "Gemini",
      "Cancer", "Leo", "Virgo", "Libra", "Scorpio", "Sagittarius"
    ];
    const zodiacDates = [20, 19, 20, 20, 21, 21, 23, 23, 23, 23, 22, 22];

    const zodiacAnimals = [
      "Rat", "Ox", "Tiger", "Rabbit", "Dragon", "Snake",
      "Horse", "Goat", "Monkey", "Rooster", "Dog", "Pig"
    ];

    function getWesternZodiac(month, day) {
      return (day < zodiacDates[month - 1]) ? zodiacSigns[(month + 10) % 12] : zodiacSigns[(month + 11) % 12];
    }

    function getKoreanZodiac(year) {
      return zodiacAnimals[(year - 4) % 12];
    }

    async function fetchAndPick(url) {
      try {
        const res = await fetch(url);
        const data = await res.json();
        if (Array.isArray(data.summary)) return randomPick(data.summary); // bojo-summary.json
        if (Array.isArray(data.wealth)) return randomPick(data.wealth);   // bojo-wealth.json
        if (Array.isArray(data.love)) return randomPick(data.love);       // bojo-love.json
        if (Array.isArray(data.health)) return randomPick(data.health);   // bojo-health.json
        if (Array.isArray(data.lucky_color)) return randomPick(data.lucky_color); // color/number ÌÜµÌï©
        if (Array.isArray(data.lucky_number)) return randomPick(data.lucky_number); 
        return "No data available.";
      } catch (e) {
        console.error('fetch error:', e);
        return "No data available.";
      }
    }

    function randomPick(arr) {
      const index = Math.floor(Math.random() * arr.length);
      return arr[index];
    }

    async function generateFortune() {
      const year = parseInt(document.getElementById('year').value);
      const month = parseInt(document.getElementById('month').value);
      const day = parseInt(document.getElementById('day').value);

      if (isNaN(year) || isNaN(month) || isNaN(day)) {
        alert('Please enter a valid birthdate.');
        return;
      }

      const zodiacAnimal = getKoreanZodiac(year);
      const zodiacSign = getWesternZodiac(month, day);

      const [summary, wealth, love, health, color1, color2, number1, number2] = await Promise.all([
        fetchAndPick(`${base}/bojo-summary.json`),
        fetchAndPick(`${base}/bojo-wealth.json`),
        fetchAndPick(`${base}/bojo-love.json`),
        fetchAndPick(`${base}/bojo-health.json`),
        fetchAndPick(`${base}/bojo-color-number.json`),
        fetchAndPick(`${base}/bojo-color-number.json`),
        fetchAndPick(`${base}/bojo-color-number.json`),
        fetchAndPick(`${base}/bojo-color-number.json`)
      ]);

      const resultHTML = `
        <div style="margin-top:20px; padding:20px; border-radius:10px; background:#f9f9f9;">
          <h2>${zodiacAnimal} + ${zodiacSign}</h2>
          <p>‚ú® <strong>Summary</strong><br>${summary}</p>
          <p>üí∞ <strong>Wealth</strong><br>${wealth}</p>
          <p>‚ù§Ô∏è <strong>Love</strong><br>${love}</p>
          <p>ü©∫ <strong>Health</strong><br>${health}</p>
          <p>üé® <strong>Lucky Color</strong><br>‚Ä¢ ${color1}<br>‚Ä¢ ${color2}</p>
          <p>üî¢ <strong>Lucky Number</strong><br>‚Ä¢ ${number1}<br>‚Ä¢ ${number2}</p>
        </div>
      `;

      document.getElementById('result').innerHTML = resultHTML;
    }
  </script>
</body>
</html>
